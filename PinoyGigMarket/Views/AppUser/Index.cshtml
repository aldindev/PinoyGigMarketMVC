@model PinoyGigMarket.Models.ProfileViewModel

@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{

}


    <div class="content">
        <div class="row">
            <div class="col-md-4">
                <div class="card card-user">
                    <div class="image">
                        <img src="~/images/bg/damir-bosnjak.jpg" alt="Bacground Pic">
                    </div>
                    <div class="card-body text-center">
                        <div class="author">
                            <a href="javascript:;" id="profilePicLink">
                                <img class="avatar border-gray" src="@(!string.IsNullOrEmpty(Model.ProfilePicturePath) ? Model.ProfilePicturePath : "/images/faces/defaultprofilepic.png")" alt="Profile Pic">
                            </a>
                            <h5 class="title">@Model.FirstName @Model.LastName</h5>

                            <p class="description">
                                @Model.Email
                            </p>
                        </div>
                        <div class="status-message-container">
                            <p id="statusMessage" class="description text-center mx-auto" style="max-width: 200px; word-wrap: break-word;">
                                @Model.StatusMessage
                            </p>
                            <input type="text" id="statusMessageInput" class="form-control" style="display:none; max-width: 200px; margin: 10px auto;" value="@Model.StatusMessage" />
                            <button id="editStatusBtn" class="btn btn-sm btn-primary">Edit Status</button>
                            <button id="saveStatusBtn" class="btn btn-sm btn-success" style="display:none;">Save</button>
                            <button id="cancelStatusBtn" class="btn btn-sm btn-secondary" style="display:none;">Cancel</button>
                        </div>
                    </div>
                    <div class="card-footer">
                        <hr>
                        <div class="button-container">
                            <div class="row">
                                <div class="col-lg-3 col-md-6 col-6 ml-auto">
                                    <h5>12<br><small>Files</small></h5>
                                </div>
                                <div class="col-lg-4 col-md-6 col-6 ml-auto mr-auto">
                                    <h5>2GB<br><small>Used</small></h5>
                                </div>
                                <div class="col-lg-3 mr-auto">
                                    <h5>24,6$<br><small>Spent</small></h5>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <form id="profilePicForm" asp-controller="AppUser" asp-action="UploadProfilePic" enctype="multipart/form-data" method="post" style="display: none;">
                    <input type="file" asp-for="ProfilePicture" id="profilePicInput" style="display: none;" />
                    <input type="hidden" asp-for="ProfilePicturePath" />
                    <input type="hidden" asp-for="FirstName" />
                    <input type="hidden" asp-for="LastName" />
                    <input type="hidden" asp-for="UserName" />
                    <input type="hidden" asp-for="Email" />
                    <input type="hidden" asp-for="StatusMessage" />

                    <input type="hidden" asp-for="AboutMe" />
                    <input type="hidden" asp-for="Address" />
                    <input type="hidden" asp-for="City" />
                    <input type="hidden" asp-for="Country" />
                    <input type="hidden" asp-for="PostalCode" />
                </form>

            </div>
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h5 class="title" id="editProfileHeader" style="display: none;">Edit Profile</h5>
                    </div>
                    <div class="card-body">
                        <form asp-controller="AppUser" asp-action="Edit" method="post" id="profileForm">
                            <div class="row">
                                <div class="col-md-5 pr-1">
                                    <div class="form-group">
                                        <label>Company (disabled)</label>
                                        <input type="text" class="form-control" disabled="" placeholder="Company" value="ABC Company">
                                    </div>
                                </div>
                                <div class="col-md-3 px-1">
                                    <div class="form-group">
                                        <label>Username</label>
                                        <input type="text" class="form-control" asp-for="UserName" id="userNameInput" />
                                        <span asp-validation-for="UserName" class="text-danger"></span>
                                    </div>
                                </div>
                                <div class="col-md-4 pl-1">
                                    <div class="form-group">
                                        <label for="exampleInputEmail1">Email address</label>
                                        <input type="email" class="form-control" asp-for="Email" id="emailInput" />
                                        <span asp-validation-for="Email" class="text-danger"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 pr-1">
                                    <div class="form-group">
                                        <label>First Name</label>
                                        <input type="text" class="form-control" asp-for="FirstName" id="firstNameInput" />
                                        <span asp-validation-for="FirstName" class="text-danger"></span>
                                    </div>
                                </div>
                                <div class="col-md-6 pl-1">
                                    <div class="form-group">
                                        <label>Last Name</label>
                                        <input type="text" class="form-control" asp-for="LastName" id="lastNameInput" />
                                        <span asp-validation-for="LastName" class="text-danger"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label>Address</label>
                                        <input type="text" class="form-control" asp-for="Address" id="AddressInput" />
                                        <span asp-validation-for="Address" class="text-danger"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4 pr-1">
                                    <div class="form-group">
                                        <label>City</label>
                                        <input type="text" class="form-control" asp-for="City" id="cityInput" />
                                        <span asp-validation-for="City" class="text-danger"></span>
                                    </div>
                                </div>
                                <div class="col-md-4 px-1">
                                    <div class="form-group">
                                        <label>Country</label>
                                        <input type="text" class="form-control" asp-for="Country" id="countryInput" />
                                        <span asp-validation-for="Country" class="text-danger"></span>
                                    </div>
                                </div>
                                <div class="col-md-4 pl-1">
                                    <div class="form-group">
                                        <label>Postal Code</label>
                                        <input type="text" class="form-control" asp-for="PostalCode" id="postalCodeInput" />
                                        <span asp-validation-for="PostalCode" class="text-danger"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label>About Me</label>
                                        <textarea class="form-control" asp-for="AboutMe" rows="4" id="aboutMeInput"></textarea>
                                        <span asp-validation-for="AboutMe" class="text-danger"></span>
                                    </div>
                                </div>
                            </div>
                            <button type="button" id="editButton" class="btn btn-primary">Edit Profile</button>
                            <button type="submit" id="saveButton" class="btn btn-primary" style="display: none;">Save Changes</button>
                            <button type="button" id="cancelButton" class="btn btn-secondary" style="display: none;">Cancel</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--   Core JS Files   -->
    <script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-3.6.0.min.js"></script>
    <script src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.19.3/jquery.validate.min.js"></script>
    <script src="https://ajax.aspnetcdn.com/ajax/jquery.validate.unobtrusive/3.2.11/jquery.validate.unobtrusive.min.js"></script>
    <script src="~/js/core/popper.min.js"></script>
    <script src="~/js/core/bootstrap.min.js"></script>
    <script src="~/js/plugins/perfect-scrollbar.jquery.min.js"></script>
    <script src="~/js/plugins/moment.min.js"></script>
    <!--  Plugin for Switches, full documentation here: http://www.jque.re/plugins/version3/bootstrap.switch/ -->
    <script src="~/js/plugins/bootstrap-switch.js"></script>
    <!--  Plugin for Sweet Alert -->
    <script src="~/js/plugins/sweetalert2.min.js"></script>
    <!-- Forms Validations Plugin -->
    <!--  Plugin for the Wizard, full documentation here: https://github.com/VinceG/twitter-bootstrap-wizard -->
    <script src="~/js/plugins/jquery.bootstrap-wizard.js"></script>
    <!--	Plugin for Select, full documentation here: http://silviomoreto.github.io/bootstrap-select -->
    <script src="~/js/plugins/bootstrap-selectpicker.js"></script>
    <!--  Plugin for the DateTimePicker, full documentation here: https://eonasdan.github.io/bootstrap-datetimepicker/ -->
    <script src="~/js/plugins/bootstrap-datetimepicker.js"></script>
    <!--  DataTables.net Plugin, full documentation here: https://datatables.net/    -->
    <script src="~/js/plugins/jquery.dataTables.min.js"></script>
    <!--	Plugin for Tags, full documentation here: https://github.com/bootstrap-tagsinput/bootstrap-tagsinputs  -->
    <script src="~/js/plugins/bootstrap-tagsinput.js"></script>
    <!-- Plugin for Fileupload, full documentation here: http://www.jasny.net/bootstrap/javascript/#fileinput -->
    <script src="~/js/plugins/jasny-bootstrap.min.js"></script>
    <!--  Full Calendar Plugin, full documentation here: https://github.com/fullcalendar/fullcalendar    -->
    <script src="~/js/plugins/fullcalendar/fullcalendar.min.js"></script>
    <script src="~/js/plugins/fullcalendar/daygrid.min.js"></script>
    <script src="~/js/plugins/fullcalendar/timegrid.min.js"></script>
    <script src="~/js/plugins/fullcalendar/interaction.min.js"></script>
    <!-- Vector Map plugin, full documentation here: http://jvectormap.com/documentation/ -->
    <script src="~/js/plugins/jquery-jvectormap.js"></script>
    <!--  Plugin for the Bootstrap Table -->
    <script src="~/js/plugins/nouislider.min.js"></script>
    <!--  Google Maps Plugin    -->
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE"></script>
    <!-- Chart JS -->
    <script src="~/js/plugins/chartjs.min.js"></script>
    <!--  Notifications Plugin    -->
    <script src="~/js/plugins/bootstrap-notify.js"></script>
    <!-- Control Center for Now Ui Dashboard: parallax effects, scripts for the example pages etc -->
    <script src="~/js/paper-dashboard.min.js?v=2.1.1" type="text/javascript"></script><!-- Paper Dashboard DEMO methods, don't include it in your project! -->
    <script src="~/demo/demo.js"></script>


    <script>
        $(document).ready(function () {
            // Toggle visibility for editing the status message
            $('#editStatusBtn').on('click', function () {
                $('#statusMessage').hide();
                $('#editStatusBtn').hide();
                $('#statusMessageInput').show().focus();
                $('#saveStatusBtn, #cancelStatusBtn').show();
            });

            $('#cancelStatusBtn').on('click', function () {
                $('#statusMessageInput').val($('#statusMessage').text()).hide();
                $('#statusMessage').show();
                $('#editStatusBtn').show();
                $('#saveStatusBtn, #cancelStatusBtn').hide();
            });

            $('#saveStatusBtn').on('click', function () {
                var newStatus = $('#statusMessageInput').val();

                $.ajax({
                    url: '@Url.Action("UpdateStatusMessage", "AppUser")',
                    type: 'POST',
                    data: {
                        statusMessage: newStatus
                    },
                    success: function (response) {
                        if (response.success) {
                            $('#statusMessage').text(newStatus).show();
                            $('#statusMessageInput').hide();
                            $('#editStatusBtn').show();
                            $('#saveStatusBtn, #cancelStatusBtn').hide();
                        } else {
                            alert("Error updating status.");
                        }
                    },
                    error: function () {
                        alert("An error occurred while updating the status.");
                    }
                });
            });

            // Edit Profile Button
            $('#editButton').on('click', function () {
                // Make inputs editable
                $('input[asp-for], textarea[asp-for]').removeAttr('readonly');
                // Show save button, cancel button, and edit profile header
                $('#saveButton, #cancelButton, #editProfileHeader').show();
                // Hide edit button
                $(this).hide();
            });

            $('#cancelButton').on('click', function () {
                // Reset the form fields
                $('#profileForm')[0].reset();
                // Make inputs read-only again
                $('input[asp-for], textarea[asp-for]').attr('readonly', 'readonly');
                // Hide save button, cancel button, and edit profile header
                $('#saveButton, #cancelButton, #editProfileHeader').hide();
                // Show edit button
                $('#editButton').show();
            });

            // Profile Picture Upload
            $('#profilePicLink').on('click', function () {
                $('#profilePicInput').click();
            });

            $('#profilePicInput').on('change', function () {
                $('#profilePicForm').submit();
            });
        });
    </script>
